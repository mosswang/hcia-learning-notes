# ICMP协议

ICMP协议(Internet Control Message Protocol)即Internet控制消息协议是IP协议的辅助协议。用来在网络设备间传递各种各种差错和控制信息。

```
# ping命令会发送ICMP数据包到目的地址
ping 10.88.55.12
```



# 功能

## ICMP重定向

一个主机向不在同一个网段发送数据时，路由器会根据路由表判断是否在同一个网段，路由器会给主机发送ICMP重定向数据包。



## ICMP差错检测

用于诊断源和目的之间的网络连通性。



## ICMP错误报告

用于诊断网络连接性问题，根据错误信息，源设备可以知道传输失败的原因。

```
tracert 10.88.55.12

TTL TTL减为0时，数据包会被丢弃
```



# 以太网协议

以太网是局域网采用的最通用的通信协议标准，定义了局域网中采用的电缆类型和信号处理方法。

以太网建立在CSMA/CD（Carrier Sense Multiple Access/Collision Detection, 载波监听多路访问/冲突检测）机制上的**广播型网络**。

这里的广播的含义：LAN中一个主机发送数据，LAN中所有主机都能收到该数据。这个LAN就是一个广播域。

冲突域：连接在同一共享介质上的所有节点的集合。使用交换机来隔离冲突域，一个端口下就是一个冲突域。



# 以太网帧

以太网技术所使用的帧就是以太网帧。以太网帧有2个标准：Ethernet_ll格式和IEEE 802.3格式。



Ethernet_ll：目的MAC地址+源MAC地址+网络层协议类型+用户数据+帧尾

IEEE 802.3：目的MAC地址+源MAC地址+长度+用户数据+帧尾

**Length/Type >= 1536(Ox0600)       Ethernet_ll （绝大部分应用传输数据使用的帧格式）**

**Length/Type <= 1500(Ox05DC)       IEEE802.3   （底层协议使用的帧格式）**



Ethernet_ll比较常用，IEEE 802.3主要用在ISIS（动态路由协议）



# MAC地址

一个MAC地址有48bit，6Byte。MAC地址即网卡地址。

```
十六进制表示法
14-DD-A9-EA-6F-B7
二进制表示法
00010100-11011101-10101001-11101010-01101111-10110111
```



## MAC地址构成

1. OUI： 厂商代码，由IEEE分配，3Byte, 24 bit。
2. 制造商分配：3Byte,  24bit。



单播MAC地址：1对1通信。前三段是OUI地址，第8位取值0

组播MAC地址：1对多通信。前三段非OUI地址，第8位取值1

广播MAC地址：FF-FF-FF-FF-FF-FF



